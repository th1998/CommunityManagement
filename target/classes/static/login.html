<!DOCTYPE HTML>
<html lang="zxx">

<head>
	<title>登录</title>
	<!-- Meta tag Keywords -->
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta charset="UTF-8" />
	<meta name="keywords" content=""/>
	<script src="./lib/layui/layui.js" charset="utf-8"></script>
	<script>
		addEventListener("load", function () {
			setTimeout(hideURLbar, 0);
		}, false);

		function hideURLbar() {
			window.scrollTo(0, 1);
		}

		layui.use(['form', 'layer'],function() {
			var form = layui.form;
			var layer = layui.layer;


			document.onkeydown = function(e){
				var ev = document.all ? window.event : e;
				if(ev.keyCode==13) {
					Login();
				}
			}

			//登录请求
			 Login = function(){
			 	var username = $("#username").val();
			 	var password = $("#password").val();
			 	if(username==""){
					layer.alert("用户名不能为空!");
				}else if(password=="") {
					layer.alert("密码不能为空!");
				}else if(password.length > 20){
					layer.alert("密码不能超过20个字符!");
				}else{
					$.ajax({
						type: "POST",
						url: "/login",
						data: {username:$("#username").val(), password:$("#password").val()},
						success: function(data){
							if(data.length == 1){
								localStorage.setItem("u_id",data[0].id);
								localStorage.setItem("c_role",data[0].role);
								//localStorage.setItem("c_id",data[0].apply.c_id);
								location.href="/index.html";
							}else {
								layer.alert("用户名或者密码不正确!");
							}
						}
					});
				}
			}

		})


	</script>

	<link rel="stylesheet" href="./css/login.css" type="text/css" media="all" />
	<link rel="stylesheet" href="https://www.jq22.com/jquery/font-awesome.4.7.0.css">

</head>

<body>
	<!-- bg effect -->
	<div id="bg">
		<canvas></canvas>
		<canvas></canvas>
		<canvas></canvas>
	</div>
	<!-- //bg effect -->
	<!-- title -->
	<h1>社团管理系统登录</h1>
	<!-- //title -->
	<!-- content -->
	<div class="sub-main-w3">
		<form action="#" method="post">
			<h2>现在登录
				<i class="fa fa-long-arrow-down"></i>
			</h2>
			<div class="form-style-agile">
				<label>
					<i class="fa fa-user"></i>
					用户名
				</label>
				<input  name="username" id="username" type="text"  lay-verify="required|username" lay-reqtext="用户名是必填项，岂能为空？" autocomplete="off">
			</div>
			<div class="form-style-agile">
				<label>
					<i class="fa fa-unlock-alt"></i>
					密码
				</label>
				<input  name="password" id="password" type="password"lay-verify="required|password" lay-reqtext="密码是必填项，岂能为空？" autocomplete="off">
			</div>
			<!-- checkbox -->
			<div class="wthree-text">
				<ul>
					<li>
						<label class="anim">
							<input type="checkbox" class="checkbox" required="">
							<span>记住密码</span>
						</label>
					</li>
					<li>
						<a href="#">忘记密码?</a>
					</li>
				</ul>
			</div>
			<!-- //checkbox -->
			<input type="button" value="登 录" onclick="Login()">
		</form>
	</div>
	<!-- //content -->

	<!-- copyright -->
	<div class="footer">
		<p>Copyright &copy; 2019.Company name All rights reserved.</p>
	</div>
	<!-- //copyright -->

	<script src="./js/jquery.min.js"></script>
	<script src="https://www.jq22.com/jquery/jquery-1.10.2.js"></script>
	<script src="./js/canva_moving_effect.js"></script>


</body>

</html>